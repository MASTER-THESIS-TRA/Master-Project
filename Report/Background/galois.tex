\section{Finite fields}
\label{Galois} 
Finite fields, synonymously Galois fields after french mathematician Ã‰variste Galois (25th October 1811 - 31st May 1832 (shot dead in a duel)\footnote{https://en.wikipedia.org/wiki/\%C3\%89variste\_Galois}), are sets with a finite number of elements. Apart from having a finite number of elements, such a set must be closed under addition, subtraction, multiplication, and division.

Apart from the need for finite fields in elliptic curve cryptography, the motivation for investigating finite fields comes from the irreversible nature of prime factorization. To be able to make RSA reversible, finite fields will hopefully make that task possible. 
\subsection{Field theory} %%Overvej en anden headline til denne section, e.g. "composition of finite fields" eller noget. 
A Galois field cannot have any number of elements. For the set to be able to satisfy the above-mentioned requirements (closed under certain operations), the number of elements in the set must be either prime or a power of a prime. The simplest fields to work with, are those with $p$ elements, where $p$ is prime. These fields, aptly named Prime Fields, contain the integer numbers $\mathbb{F}_p=\{0,1,2,..,p-1\}$\footnote{The notation $\mathbb{F}_p$ is shorthand for the Field with $p$ elements.}.

A finite field can, as previously mentioned, also have a number of elements that is equal to the power of a prime. More generally, Galois Fields must have $p^m$ number of elements, where $p$ must be prime, and $m$ must be a positive integer. By this definition, Prime Fields are simply Galois Fields with $p^1$ elements. A Galois Field with $m>1$ is called an Extension Field, and consist of more complicated elements. To be able to keep the set closed under addition and multiplication, the elements of the set must be polynomials rather than integers. The polynomials in an Extension Field are on the form:
\[c_1x^{m-1}+..+c_{m-1}x+c_{m}\]
where the constants $c_{i}$ with $0<i\leq m$ are integers, such that $0\leq c_{i}< p$. That is, the polynomials will be of $m-1^{th}$ degree, and the coefficients can have values ranging from $0$ to $p-1$. Other variations of extension fields exist, where the numbers are not strictly represented as polynomials, but due to the neat representation presented next, this paper will stick to polynomials for the elements of the fields.\\

A particularly interesting family of finite fields, especially in the world of computer science, are those where $p=2$. Such fields are particularly nice to encode, as the polynomials can be represented as bit-sequences. That is, a polynomial of degree 7 in $\mathtt{mod}2$, can be represented with a byte, where each bit corresponds to a nomial:
\[x^7+x^6+x^5+x^4+x^3+x^2+x+1:=11111111\]
As this is also an unsigned integer representation, it is possible to do finite field computations using integers, if working in a finite field of characteristic 2. These computations are, however, somewhat different from regular integer arithmetics, so some considerations need to be taken.

\subsection{Finite field arithmetics}
Computations in finite fields depend on the field in which they are performed. The simplest fields to do arithmetics in are prime fields. In prime fields, arithmetic operations are simply performed modulo $p$, where $p$ is the number of elements in the field. To demonstrate this, consider the finite field with 7 elements $\mathbb{F}_7=\{0,1,2,3,4,5,6\}$. This is clearly a prime field, and so arithmetics should be simple to perform. With 7 elements in the field, the computations must be performed $\mathtt{mod}7$. Any arithmetic operation that lands within the field, will remain the same, as the modulo will leave it unchanged:
\[1+2=3 ~ \mathtt{mod} ~ 7=3\]
\[4+2=6 ~ \mathtt{mod} ~ 7=6\]
\[5+2=7 ~ \mathtt{mod} ~ 7=0\]
\[2*3=6 ~ \mathtt{mod} ~ 7=6\]
\[2*4=8 ~ \mathtt{mod} ~ 7=1\]
The last product demonstrates how $2$ and $4$ are each others multiplicative inverse in the finite field $\mathbb{F}_7=\{0,1,2,3,4,5,6\}$.\\

\noindent When doing arithmetics in extension fields, there are some obvious differences, as the elements of such fields are polynomials, rather than integer numbers. Some arithmetics are, however, still fairly simple to perform. Addition and subtraction are done with regular polynomial addition/subtraction, but modulo the characteristic of the field. That is, polynomials are added/subtracted term-by-term modulo $p$. As a small example, consider the field:
\[\mathbb{F}_9=\mathbb{F}_{3^2}=\begin{Bmatrix}
0 & x   & 2x   \\
1 & x+1 & 2x+1 \\
2 & x+2 & 2x+2
\end{Bmatrix}
\]
Some simple arithmetic operations could be:
\[1+2=3 ~ \mathtt{mod} ~ 3=0\]
\[(1)+(x)=((0+1) ~ \mathtt{mod} ~ 3)x+((0+1) ~ \mathtt{mod} ~ 3)=x+1\]
\[(2x+1)+(x+2)=((2+1) ~ \mathtt{mod} ~ 3)x+((1+2) ~ \mathtt{mod} ~ 3)=0\]
Apart from the fact that the operands are polynomials, this sort of arithmetics are fairly straight forward. Unfortunately, multiplication becomes a bit more intricate. The method for addition presents several issues. First of all, multiplication modulo the characteristic of the field is ambiguous. To see this, simply consider:
\[(1*1) ~ \mathtt{mod} ~ 3=1=4 ~ \mathtt{mod} ~ 3=(2*2) ~ \mathtt{mod} ~ 3\]
Secondly, multiplying polynomials can result in a polynomial of a higher degree, even if the nominal are modulo the characteristic of the field:
\[((x+1)(2x+2)) ~ \mathtt{mod} ~ 3=2x^2+x+2\]
But this is not an element in the field, and so the field is not closed under multiplication this way. To get around these issues, multiplication needs to be done modulo an irreducible polynomial of degree $m$ for a field $\mathbb{F}_{p^m}$. This polynomial only needs to be irreducible over the field, so, simply speaking, it is a polynomial that cannot be represented as a product of two elements of the field, and that has coefficients that belong to the field. Such a polynomial always exists, and there is not necessarily only one such polynomial for a field. Therefore, it is necessary to include the irreducible polynomial in the definition of the field, as a different polynomial will result in a different field.

When a polynomial has been selected, multiplication is now done modulo this polynomial. That is, a product is found by multiplying the two operands, and then finding the remainder after long division of that product with the irreducible polynomial. To demonstrate this, the example field above can be defined with the irreducible polynomial $x^2+1$. As mentioned above, this polynomial is not uniquely irreducible in $\mathbb{F}_9$, but there are, in fact, 2 other polynomials that could be used instead: $x^2+x+2$ or $x^2+2x+2$. There exist algebraic methods for finding such irreducible polynomials\cite{findingIrreducible}, but this is outside the area of interest for this paper.

Defining the field with the polynomial $x^2+1$ can be written using the notation $\mathbb{F}_9[x]/x^2+1$.

With the polynomial determined, multiplication can now be done modulo $x^2+1$. While performing the multiplication and long division, all intermediate calculations are done modulo the characteristic of the field. To demonstrate, here is shown the computations of $(2x+2)(x+1)$:
\[(2x+2)(x+1) ~ \mathtt{mod} ~ (x^2+1)\]
\[=2x^2+x+2 ~ \mathtt{mod} ~ (x^2+1)\]
Now simply do long division, to find the remainder:\\
\begin{center}
\setstackgap{S}{1.5pt}
\stackMath\def\stackalignment{r}
\(
\stackunder{%
  x^2+1 \stackon[1pt]{\showdiv{2x^2+x+2}}{2}%
}{%
\Shortstack[l]{{\underline{2x^2\ph{+~x}+2}} \ph{2x^2+}x\ph{+2}}%
}
\)
\end{center}
And so the product of $2x+2$ and $x+1$ in $GF(3)[x]/x^2+1$ is $x$, which is indeed within the field.
\subsubsection{Arithmetics in characteristic 2 finite fields}
As mentioned at the beginning of this section, the extension fields with characteristic 2, that is $\mathbb{F}_{2^m}$, can be very neatly represented using bit-sequences. Furthermore, the arithmetics in such fields are also very pleasant to implement on a machine, as bit-wise operations can be used instead of needing to implement/use complicated libraries for polynomial arithmetics. Consider the most basic operations: addition and subtraction. In a field with characteristic 2, these operations become simpler, as adding or subtracting  $1\texttt{mod}2$ yields the same result.
\\
\begin{table}[!h]
\begin{center}
\begin{tabular}{|l|l|l|}
\hline
+/- & 0 & 1 \\ \hline
0   & 0 & 1 \\ \hline
1   & 1 & 0 \\ \hline
\end{tabular}
\end{center}
\end{table}
Note that this is the same table as that of the \texttt{XOR} (exclusive-or) operation, and so a simple polynomial addition/subtraction in a field with characteristic 2 can be done using \texttt{XOR}.

In a similar way, it is possible to implement polynomial long division using a combination of \texttt{XOR} (inplace of subtraction) and shifting. An example of a modular operation\cite{finiteFieldArithmetics} using such a method can be seen in Figure \ref{longmod}.
\begin{figure}[!h]\small
\begin{verbatim} 
          11111101111110 (mod) 100011011
         ^100011011     
          --------------
          01110000011110
          ^100011011    
           -------------
           0110110101110
           ^100011011   
            ------------
            010101110110
            ^100011011  
             -----------
             00100011010
              ^100011011
               ---------  
               000000001
\end{verbatim}
\caption{Polynomial modulo using binary operations.} 
\label{longmod}
\end{figure}


With this in mind, arithmetic operations in characteristic 2 finite fields can then be implemented as relatively simple methods, using primarily binary operations. An example can be seen in Figure \ref{finitearithmetics}. This implementation is from the Wikipedia page for finite field arithmetics\cite{finiteFieldArithmetics}, except comments have been removed to fit the page. 
\begin{figure}\small
\begin{verbatim}
uint8_t gadd(uint8_t a, uint8_t b) {
    return a ^ b;
}

uint8_t gmul(uint8_t a, uint8_t b) {
    uint8_t p = 0;
    while (a && b) {
        if (b & 1) 
            p ^= a; 

        if (a & 0x80) 
            a = (a << 1) ^ 0x11b; 
        else
            a <<= 1; 
        b >>= 1; 
    }
    return p;
}
\end{verbatim}
\caption{\texttt{C} implementation of finite field arithmetics in $\mathbb{F}_{2^8}$.}
\label{finitearithmetics}
\end{figure}